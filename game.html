<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>보이스피싱</title>
    <link rel="stylesheet" href="gameStyle.css" />
  </head>
  <body>
    <div class="aspect-ratio-box">
      <img src="TempPlayer.png" alt="캐릭터" class="character" id="character" />
      <div class="content">
        <!-- 상단 디스플레이 표시 -->
        <div class="display-container">
          <div class="display">남은 시간: 60</div>
          <div class="display">획득 골드: 6000</div>
        </div>
        <!-- 하단 버튼 -->
        <div class="button-container">
          <button class="button" id="left-button">◀</button>
          <button class="button">▼</button>
          <button class="button" id="right-button">▶</button>
        </div>
      </div>
    </div>

    <script>
      const character = document.getElementById("character");
      let position = 30; // CSS와 동일하게 초기 위치 설정 (%)
      let moveInterval; // 이동을 위한 interval 변수
      let isMoving = false; // 이동 중인지 여부를 체크하는 변수

      // 초기 위치를 CSS와 동기화
      character.style.left = position + "%";

      // 캐릭터 이동 함수
      function moveCharacter(direction) {
        if (direction === "left") {
          position -= 1; // 왼쪽으로 이동
          if (position < 0) position = 0; // 화면 밖으로 나가지 않도록 제한
        } else if (direction === "right") {
          position += 1; // 오른쪽으로 이동
          if (position > 100) position = 100; // 화면 밖으로 나가지 않도록 제한
        }
        character.style.left = position + "%";
      }

      // 버튼이 눌렸을 때 interval 시작
      function startMoving(direction) {
        if (isMoving) return; // 이미 이동 중이면 중복 실행 방지
        isMoving = true; // 이동 상태로 전환
        moveCharacter(direction); // 첫 이동 즉시 실행
        moveInterval = setInterval(() => moveCharacter(direction), 50); // 이후 50ms 간격 이동
      }

      // 버튼에서 손을 뗐을 때 interval 중지
      function stopMoving() {
        clearInterval(moveInterval);
        moveInterval = null;
        isMoving = false; // 이동 상태 해제
      }

      // 이벤트 리스너 등록
      const leftButton = document.getElementById("left-button");
      const rightButton = document.getElementById("right-button");

      // 마우스 입력 이벤트
      leftButton.addEventListener("mousedown", () => startMoving("left"));
      rightButton.addEventListener("mousedown", () => startMoving("right"));
      leftButton.addEventListener("mouseup", stopMoving);
      rightButton.addEventListener("mouseup", stopMoving);
      leftButton.addEventListener("mouseleave", stopMoving);
      rightButton.addEventListener("mouseleave", stopMoving);

      // 터치 입력 이벤트 (모바일용)
      leftButton.addEventListener("touchstart", (e) => {
        e.preventDefault(); // 터치 시 기본 동작 방지
        startMoving("left");
      });
      rightButton.addEventListener("touchstart", (e) => {
        e.preventDefault();
        startMoving("right");
      });
      leftButton.addEventListener("touchend", stopMoving);
      rightButton.addEventListener("touchend", stopMoving);
    </script>
  </body>
</html>
